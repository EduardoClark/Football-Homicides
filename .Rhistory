custom.note="Notes: Estimated coefficients from a negative binomial regression model are reported. Standard errors are in parentheses. Although not shown, controls for day of the week, month, and year are included."
)
screenreg(list(m1,m2,m3) , single.row=TRUE ,
custom.model.names=c("Homicidios", "Homicidios", "Homicidios"),
omit.coef = "as.factor",
reoder.coef=c(1,21:26,2:20)),
screenreg(list(m1,m2,m3) , single.row=TRUE ,
custom.model.names=c("Homicidios", "Homicidios", "Homicidios"),
omit.coef = "as.factor",
reoder.coef=c(1,21:26,2:20))
,
htmlreg(list(m1,m2,m3) , single.row=TRUE ,
custom.model.names=c("Homicidios", "Homicidios", "Homicidios"),
omit.coef = "as.factor",
reoder.coef=c(1,21:26,2:20), caption.above="Football Games and Homicides"
custom.note="Notes: Estimated coefficients from a negative binomial regression model are reported. Standard errors are in parentheses. Although not shown, controls for day of the week, month, and year are included."
htmlreg(list(m1,m2,m3) , single.row=TRUE ,
custom.model.names=c("Homicidios", "Homicidios", "Homicidios"),
omit.coef = "as.factor",
reoder.coef=c(1,21:26,2:20), caption.above="Football Games and Homicides",
custom.note="Notes: Estimated coefficients from a negative binomial regression model are reported. Standard errors are in parentheses. Although not shown, controls for day of the week, month, and year are included."
)
htmlreg(list(m1,m2,m3) , single.row=TRUE ,
custom.model.names=c("Homicidios", "Homicidios", "Homicidios"),
omit.coef = "as.factor",
reoder.coef=c(1,21:26,2:20), caption="Football Games and Homicides",
custom.note="Notes: Estimated coefficients from a negative binomial regression model are reported. Standard errors are in parentheses. Although not shown, controls for day of the week, month, and year are included."
)
screenreg(list(m1,m2,m3) , single.row=TRUE ,
custom.model.names=c("Homicidios", "Homicidios", "Homicidios"),
omit.coef = "as.factor",
reoder.coef=c(1,21:26,2:20), caption="Football Games and Homicides",
custom.note="Notes: Estimated coefficients from a negative binomial regression model are reported. Standard errors are in parentheses. Although not shown, controls for day of the week, month, and year are included."
)
exp(.36)
exp(.8)
exp(.4)
exp(.34)
exp(.53)
exp(.38)
screenreg(list(m1,m2,m3) , single.row=TRUE ,
custom.model.names=c("Homicidios", "Homicidios", "Homicidios"),
omit.coef = "as.factor",
reoder.coef=c(1,21:26,2:20), caption="Football Games and Homicides",
custom.note="Notes: Estimated coefficients from a negative binomial regression model are reported. Standard errors are in parentheses. Although not shown, controls for day of the week, month, and year are included."
)
.38
exp(.38)
exp(.34)
exp(.36)
exp(.53)
exp(.41)
exp(.34)
View(Panel1)
source("src/loadLibraries.R") #Load Libraries
?arrange
Pane1$PreDayHom <- arrange(Panel1, Panel1$Fecha, Panel1$Ciudad)
Panel1 <- arrange(Panel1, Panel1$Fecha, Panel1$Ciudad)
View(Panel1)
Panel1 <- arrange(Panel1, Panel1$Ciudad)
View(Panel1)
Panel1$PreDayHom <- c(NA, Panel1$Homicidios)
Panel1$Homicidios[-29234,]
Panel1$Homicidios[,-29234]
View(Panel1)
Panel1[3,-29234]
HomTmp <- Panel1$Homicidios
HomTmp[[-29234]]
HomTmp[[,-29234]]
HomTmp[[29234]] <- NULL
HomTmp[29234] <- NULL
HomTmp <- subset(Panel1, select=3)
HomTmp <- HomTmp[,-29234]
HomTmp
HomTmp <- subset(Panel1, select=3)
HomTmp <- HomTmp[-29234,]
HomTmp
Panel1$PreDayHom <- c(NA, HomTmp)
View(Panel1)
HomTmp <- subset(Panel1, select=3)
HomTmp <- HomTmp[-1,]
Panel1$AftDayHom <- c( HomTmp,NA)
View(Panel1)
min(Panel1$Fecha)
Panel1$PreDayHom <- ifelse(Panel1$Fecha=="2007-01-02", NA, Panel1$PreDayHom)
max(Panel1$Fecha)
Panel1$AftDayHom <- ifelse(Panel1$Fecha=="2011-12-31", NA, Panel1$AftDayHom)
Panel1$PreDayHom
colnames(Panel1)
m1 <- glm.nb(Homicidios ~
Partido +
as.factor(Anio) +
as.factor(Month) +
as.factor(Dia) +
PreDayHom +
AftDayHom,
data = Panel1) ##Negative Binomial with all games included
summary(m1)
summary(m2)
summary(m1)
m1 <- glm.nb(Homicidios ~
Partido +
as.factor(Anio) +
as.factor(Month) +
as.factor(Dia) +
PreDayHom ,
data = Panel1) ##Negative Binomial with all games included
summary(m1)
exp(.1186)
m2 <- glm.nb(Homicidios ~
PartidoCasa +
PartidoVisita +
as.factor(Anio) +
as.factor(Month) +
as.factor(Dia) +
PreDayHom,
data = Panel1) ##Negative Binomial with all games included
summary(m2)
exp(.34)
m4 <- glmmadmb(Homicidios ~
Partido +
as.factor(Anio) +
as.factor(Month) +
as.factor(Dia),
PreDayHom,
family="nbinom",
zeroInflation=TRUE,
data = Panel1) ##Negative Binomial with all games included
m4 <- glmmadmb(Homicidios ~
Partido +
as.factor(Anio) +
as.factor(Month) +
as.factor(Dia) +
PreDayHom,
family="nbinom",
zeroInflation=TRUE,
data = Panel1) ##Negative Binomial with all games included
summary(m4)
exp(.12)
exp(.122261)
m4 <- glmmadmb(Homicidios ~
Partido +
as.factor(Anio) +
as.factor(Month) +
as.factor(Dia) +
log(PreDayHom) +
log(AftDayHom),
family="nbinom",
zeroInflation=TRUE,
data = Panel1) ##Negative Binomial with all games included
m4 <- glmmadmb(Homicidios ~
Partido +
as.factor(Anio) +
as.factor(Month) +
as.factor(Dia) +
log(PreDayHom)
,
family="nbinom",
zeroInflation=TRUE,
data = Panel1) ##Negative Binomial with all games included
m4 <- glmmadmb(Homicidios ~
Partido +
as.factor(Anio) +
as.factor(Month) +
as.factor(Dia) +
PreDayHom,
family="nbinom",
zeroInflation=TRUE,
data = Panel1) ##Negative Binomial with all games included
m4 <- glmmadmb(Homicidios ~
Partido +
as.factor(Anio) +
as.factor(Month) +
as.factor(Dia) +
PreDayHom,
family="nbinom",
zeroInflation=TRUE,
data = Panel1) ##Negative Binomial with all games included
m4 <- glmmadmb(Homicidios ~
Partido +
as.factor(Anio) +
as.factor(Month) +
as.factor(Dia) ,
family="nbinom",
zeroInflation=TRUE,
data = Panel1) ##Negative Binomial with all games included
summary(m4)
m4 <- glmmadmb(Homicidios ~
PartidoCasa +
PartidoVisita +
as.factor(Anio) +
as.factor(Month) +
as.factor(Dia) ,
family="nbinom",
zeroInflation=TRUE,
data = Panel1) ##Negative Binomial with all games included
summary(m4)
m4 <- glmmadmb(Homicidios ~
PartidoCasa +
PartidoVisita +
as.factor(Anio) +
as.factor(Month) +
as.factor(Dia)+
PreDayHom,
family="nbinom",
zeroInflation=TRUE,
data = Panel1) ##Negative Binomial with all games included
summary(m4)
H1 <- zeroinfl(Homicidios ~  Anio + Month + Dia | Partido , data = Panel1, dist="negbin")
summary(H1)
H1 <- zeroinfl(Homicidios ~ Partido + Anio + Month + Dia  , data = Panel1, dist="negbin")
exp(.23)
exp(.2391447)
??screenreg
install.packages("texreg")
remove(list=ls())
Jornadas <- "http://www.terra.com.mx/futbol_mexicano/articulo/366302/Calendario+++Apertura+2007.htm"
Jornadas <- c(Jornadas, paste("http://www.terra.com.mx/futbol_mexicano/articulo/366302/Calendario+++Apertura+2007.htm&paginaid=", 1:21, sep=""))
Extractor <- function(URL){
frame <- ldply(readHTMLTable(htmlParse(URL, encoding="UTF"))[9])
}
Info <- ldply(lapply(Jornadas, Extractor))
Info$.id <- NULL
Info <- subset(Info, select=1:6)
source("src/loadLibraries.R") #Load Libraries
source("src/GameDates.R") ## Get Game Dates from 2007-2011
source("src/CleanMatches.R") ## Clean Game Dates and create complete DF of Game Dates
View(Complete)
source("src/HomicideData.R") ## Load Homicide Data and merge with Game Dates
?wday
??wday
install.packages("lubridate")
remove(list=ls())
source("src/loadLibraries.R") #Load Libraries
source("src/loadLibraries.R", echo=FALSE) #Load Libraries
install.packages("Zelig")
source("src/loadLibraries.R") #Load Libraries
install.packages("tseries")
source("src/loadLibraries.R") #Load Libraries
install.packages("lmtest")
source("src/loadLibraries.R") #Load Libraries
install.packages("pscl")
source("src/loadLibraries.R") #Load Libraries
install.packages("glmmADMB")
source("src/loadLibraries.R") #Load Libraries
install.packages("glmmADMB")
install.packages("glmmADMB",
repos=c("http://glmmadmb.r-forge.r-project.org/repos",
getOption("repos")),type="source")
source("src/loadLibraries.R") #Load Libraries
install.packages("gcc")
source("src/loadLibraries.R") #Load Libraries
source("src/loadLibraries.R") #Load Libraries
source("src/GameDates.R") ## Get Game Dates from 2007-2011
source("src/CleanMatches.R") ## Clean Game Dates and create complete DF of Game Dates
source("src/HomicideData.R") ## Load Homicide Data and merge with Game Dates
View(Panel)
plot(density(Panel$Homicidios))
plot(density(Panel$Homicidios, na.rm=TRUE))
max(Panel$Homicidios, na.rm=TRUE)
table(is.na(Panel$Homicidios))
Panel$Homicidios <- ifelse(is.na(Panel$Homicidios)==TRUE, 0 Panel$Homicidios)
Panel$Homicidios <- ifelse(is.na(Panel$Homicidios)==TRUE, 0 ,Panel$Homicidios)
GamesSt1 <- ldply(table(Panel1$Dia))
source("src/EffectsEstimation.R")
colnames(Panel1)
remove(HomTmp)
m1 <- glm.nb(Homicidios ~
Partido +
as.factor(Anio) +
as.factor(Month) +
as.factor(Dia) +
PreDayHom ,
data = Panel1) ##Negative Binomial with all games included
m2 <- glm.nb(Homicidios ~
PartidoCasa +
PartidoVisita +
as.factor(Anio) +
as.factor(Month) +
as.factor(Dia) +
PreDayHom,
data = Panel1) ##Negative Binomial (divided between Home and Away Games)
m3 <- glm.nb(Homicidios ~
Ganador +
as.factor(Anio) +
as.factor(Month) +
as.factor(Dia),
data = Panel1) ##Negative Binomial (divided by winner)
m4 <- glmmadmb(Homicidios ~
PartidoCasa +
PartidoVisita +
as.factor(Anio) +
as.factor(Month) +
as.factor(Dia) ,
family="nbinom",
zeroInflation=TRUE,
data = Panel1) ##Negative Binomial wi
m4$coefficients <- m4$b
m <- (est <- cbind(Estimate = coef(m1), confint(m1)))
m
est <- cbind(Estimate = coef(m1), confint(m1)) ## CI for coeffs
est
exp(est) ## Get the non-log CI for the coeffs
summary(m2)
exp(.146)
m3 <- glm.nb(Homicidios ~
Ganador +
as.factor(Anio) +
as.factor(Month) +
as.factor(Dia) +
PreDayHom,
data = Panel1) ##Negative Binomial (divided by winner)
summary(m3)
exp(.3205)
H1 <- zeroinfl(Homicidios ~  Anio + Month + Dia | Partido , data = Panel1, dist="negbin")
summary(H1)
qcc.overdispersion.test(Panel1$Homicidios,type="poisson")
e1 <- m1; e1$coefficients <- exp(e1$coefficients)
e2 <- m2; e2$coefficients <- exp(e2$coefficients)
e3 <- m3; e3$coefficients <- exp(e3$coefficients)
e1
summary(e1)
summary(e2)
summary(e3)
e1$converged
e1$residuals
sum(e1$residuals)
sum(abs(e1$residuals))
sum(abs(e2$residuals))
sum(abs(e3$residuals))
screenreg(list(m1,m2,m3) , single.row=TRUE ,
custom.model.names=c("Homicidios", "Homicidios", "Homicidios"),
omit.coef = "as.factor",
reoder.coef=c(1,21:26,2:20), caption="Football Games and Homicides",
custom.note="Notes: Estimated coefficients from a negative binomial regression model are reported. Standard errors are in parentheses. Although not shown, controls for day of the week, month, and year are included."
)
custom.coef.names=c("Intercept", "Game (Home or Away)", "Home Game", "Away Game",
"Team Wins", "Team Ties", "Team Loses", rep("as.factor",21)))
screenreg(list(m1,m2,m3) , single.row=TRUE ,
custom.model.names=c("Homicidios", "Homicidios", "Homicidios"),
omit.coef = "as.factor",
reoder.coef=c(1,21:26,2:20), caption="Football Games and Homicides",
custom.note="Notes: Estimated coefficients from a negative binomial regression model are reported. Standard errors are in parentheses. Although not shown, controls for day of the week, month, and year are included."
)
screenreg(list(m1,m2,m3) , single.row=TRUE ,
custom.model.names=c("Homicidios", "Homicidios", "Homicidios"),
omit.coef = "as.factor",
reoder.coef=c(1,21:26,2:20), caption="Football Games and Homicides",
custom.note="Notes: Estimated coefficients from a negative binomial regression model are reported. Standard errors are in parentheses. Although not shown, controls for day of the week, month, and year are included."
+,
custom.coef.names=c("Intercept", "Game (Home or Away)", "Home Game", "Away Game",
"Team Wins", "Team Ties", "Team Loses", rep("as.factor",21)))
anova(m1, m4, test = "Chisq")
remove(list=ls())
remove(list=ls())
source("src/loadLibraries.R") #Load Libraries
source("src/GameDates.R") ## Get Game Dates from 2007-2011
source("src/CleanMatches.R") ## Clean Game Dates and create complete DF of Game Dates
source("src/HomicideData.R") ## Load Homicide Data and merge with Game Dates
source("src/EffectsEstimation.R") #Some estimation scripts and more data cleaning
source("src/NegativeBinomial.R")  #Estimation results from the negative binomial and ZI models
GamesSt1 <- ldply(table(Panel1$Dia))
colnames(GamesSt1) <- c("Category", "Observations")
tmp <- data.frame(Category="Total Days", Observations=29234)
GamesSt1 <- rbind(tmp, GamesSt1);remove(tmp)
GamesSt1$Observations <- format(GamesSt1$Observations, big.mark=",")
tmp1 <- subset(Panel1, Panel1$Partido=="Si")
tmp2 <- subset(Panel1, Panel1$Partido=="No")
GamesSt2 <- ldply(table(tmp1$Dia))
colnames(GamesSt2) <- c("Category", "Game")
tmp <- data.frame(Category="Total Days", Game=2366)
GamesSt2 <- rbind(tmp, GamesSt2);remove(tmp)
GamesSt2$Game <- format(GamesSt2$Game, big.mark=",")
GamesSt1 <- cbind(GamesSt1, GamesSt2$Game)
colnames(GamesSt1) <- c("Day", "Total Observations", "Game(Yes)")
GamesSt2 <- ldply(table(tmp2$Dia))
colnames(GamesSt2) <- c("Category", "Game")
tmp <- data.frame(Category="Total Days", Game=26868)
GamesSt2 <- rbind(tmp, GamesSt2);remove(tmp)
GamesSt2$Game <- format(GamesSt2$Game, big.mark=",")
GamesSt1 <- cbind(GamesSt1, GamesSt2$Game)
colnames(GamesSt1) <- c("Day", "Total Observations", "Game(Yes)", "Game(No)")
T1 <- xtable(GamesSt1, label="Days-City Observations")
remove(tmp1, tmp2, GamesSt1, GamesSt2)
T1
MeanDay <- data.frame(GameYes=NA, GameNo=NA, Day=NA, pValue=NA, AllDays=NA, HomeGame=NA, AwayGame=NA)
tmp <- as.data.frame(t(ldply(tapply(Panel1$Homicidios, Panel1$Partido, mean))))
Test1 <- t.test( subset(Panel1, Panel1$PartidoCasa=="Si")[[3]],
subset(Panel1, Panel1$PartidoVisita=="Si")[[3]])
tmp <- tmp[2,]
tmp$V3 <- "All Days"
tmp$V4 <- round(Test1$p.value,5)
tmp$V5 <- mean(Panel1$Homicidios)
tmp3 <- subset(Panel1, Panel1$PartidoCasa=="Si")
tmp$V6 <- mean(tmp3$Homicidios)
tmp4 <- subset(Panel1, Panel1$PartidoVisita=="Si")
tmp$V7 <- mean(tmp4$Homicidios)
colnames(tmp) <- c("GameYes", "GameNo", "Day", "pValue", "AllDays", "HomeGame", "AwayGame")
MeanDay <- rbind(MeanDay, tmp)
Days <- as.character(unique(Panel1$Dia))
for (i in 1:7){
tmp1 <- subset(Panel1, Panel1$Dia==Days[i])
tmp2 <- t.test( subset(Panel1, Panel1$PartidoCasa=="Si")[[3]],
subset(Panel1, Panel1$PartidoVisita=="Si")[[3]])
tmp2 <- t.test( subset(tmp1, Panel1$PartidoVisita=="Si")[[3]],
subset(tmp1, Panel1$Partido=="No")[[3]])
tmp <- as.data.frame(t(ldply(tapply(tmp1$Homicidios, tmp1$Partido, mean))))
tmp <- tmp[2,]
tmp$V3 <- Days[i]
tmp$V4 <- round(tmp2$p.value,5)
tmp$V5 <- mean(tmp1$Homicidios)
tmp3 <- subset(tmp1, tmp1$PartidoCasa=="Si")
tmp$V6 <- mean(tmp3$Homicidios)
tmp4 <- subset(tmp1, tmp1$PartidoVisita=="Si")
tmp$V7 <- mean(tmp4$Homicidios)
colnames(tmp) <- c("GameYes", "GameNo", "Day", "pValue", "AllDays","HomeGame", "AwayGame")
MeanDay <- rbind(MeanDay, tmp)
remove(list=ls(pattern="tmp"))
}
remove(i, Days)
MeanDay <- MeanDay[-1,]
MeanDay <- subset(MeanDay, select=c(3,5,1,2,6,7,4))
MeanDay$GameYes <- round(as.numeric(MeanDay$GameYes), 2)
MeanDay$GameNo <- round(as.numeric(MeanDay$GameNo), 2)
Days <- as.character(unique(Panel1$Dia))
Days <- data.frame(Days=Days, Corre=c(4,5,6,7,8,2,3))
MeanDay <- merge(MeanDay, Days,by=1, all=TRUE)
MeanDay[1,8] <- 1
MeanDay <- arrange(MeanDay, MeanDay$Corre)
MeanDay$Corre <- NULL
T2 <- xtable(MeanDay)
remove(Test1, Days)
T2
tmp2 <- subset(Panel1, Panel1$Partido=="Si")
tmp3 <- ldply(table(tmp2$Ciudad))
tmp2 <- subset(Panel1, Panel1$PartidoCasa=="Si")
tmp4 <- ldply(table(tmp2$Ciudad))
tmp2 <- subset(Panel1, Panel1$PartidoVisita=="Si")
tmp5 <- ldply(table(tmp2$Ciudad))
colnames(tmp3) <- c("Ciudad", "TotalGameDays")
colnames(tmp4) <- c("Ciudad", "HomeGameDays")
colnames(tmp5) <- c("Ciudad", "AwayGameDays")
GamesCity <- merge(tmp3, tmp4, by=1)
GamesCity <- merge(GamesCity, tmp5, by=1)
remove(list=ls(pattern="tmp"))
GamesCity <- arrange(GamesCity, desc(GamesCity$TotalGameDays))
T4 <- xtable(GamesCity)
remove(GamesCity, MeanDay)
T4
write(T1, file="latex-plots/T1")
T1
cat(T1)
cat(print(T1))
write(print(T1), file="latex-plots/T1")
write(print(T2), file="latex-plots/T2")
write(print(T4), file="latex-plots/T1")
remove(T1,T2,T4)
T2 <- xtable(m1)
T2
?xtable
?screenreg
R1 <- texreg(m1)
R1 <- texreg(list(m1,m2,m3) , single.row=TRUE ,
custom.model.names=c("Homicidios", "Homicidios", "Homicidios"),
omit.coef = "as.factor",
reoder.coef=c(1,21:26,2:20), caption="Football Games and Homicides",
custom.note="Notes: Estimated coefficients from a negative binomial regression model are reported. Standard errors are in parentheses. Although not shown, controls for day of the week, month, and year are included."
)
R1
R1 <- texreg(list(m1,m2,m3) , single.row=TRUE ,
custom.model.names=c("Homicidios", "Homicidios", "Homicidios"),
omit.coef = "as.factor",
reoder.coef=c(1,21:26,2:20), caption="Football Games and Homicides",
custom.note="Notes: Estimated coefficients from a negative binomial regression model are reported. Standard errors are in parentheses. Although not shown, controls for day of the week, month, and year are included."
)
R1
write(print(texreg(list(m1,m2,m3) , single.row=TRUE ,
custom.model.names=c("Homicidios", "Homicidios", "Homicidios"),
omit.coef = "as.factor",
reoder.coef=c(1,21:26,2:20), caption="Football Games and Homicides",
custom.note="Notes: Estimated coefficients from a negative binomial regression model are reported. Standard errors are in parentheses. Although not shown, controls for day of the week, month, and year are included."
)), "R1")
?texreg
texreg(file="latex-plots/R1",list(m1,m2,m3) , single.row=TRUE ,
custom.model.names=c("Homicidios", "Homicidios", "Homicidios"),
omit.coef = "as.factor",
reoder.coef=c(1,21:26,2:20), caption="Football Games and Homicides",
custom.note="Notes: Estimated coefficients from a negative binomial regression model are reported. Standard errors are in parentheses. Although not shown, controls for day of the week, month, and year are included."
)
texreg(file="latex-plots/R2",list(e1,e2,33) , single.row=TRUE ,
custom.model.names=c("Homicidios", "Homicidios", "Homicidios"),
omit.coef = "as.factor",
reoder.coef=c(1,21:26,2:20), caption="Football Games and Homicides (Exponential coefficients shown)",
custom.note="Notes: Estimated coefficients from a negative binomial regression model are reported. Standard errors are in parentheses. Although not shown, controls for day of the week, month, and year are included."
)
texreg(file="latex-plots/R2",list(e1,e2,e3) , single.row=TRUE ,
custom.model.names=c("Homicidios", "Homicidios", "Homicidios"),
omit.coef = "as.factor",
reoder.coef=c(1,21:26,2:20), caption="Football Games and Homicides (Exponential coefficients shown)",
custom.note="Notes: Estimated coefficients from a negative binomial regression model are reported. Standard errors are in parentheses. Although not shown, controls for day of the week, month, and year are included."
)
remove(list=ls())
source("src/loadLibraries.R") #Load Libraries
#Get and clean data
source("src/GameDates.R") ## Get Game Dates from 2007-2011
source("src/CleanMatches.R") ## Clean Game Dates and create complete DF of Game Dates
source("src/HomicideData.R") ## Load Homicide Data and merge with Game Dates
#Game Day effect estimation
source("src/EffectsEstimation.R") #Some estimation scripts and more data cleaning
source("src/NegativeBinomial.R")  #Estimation results from the negative binomial and ZI models
#Summary Statistics for tables
source("src/SummaryStatistics.R") ##Latex Text outputs to latex-plots
